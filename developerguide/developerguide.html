<!DOCTYPE html>
<html>
<head>
  <title>  | WattDepot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/3.1.0/cerulean/bootstrap.min.css">

  <!--  Load site-specific customizations after bootstrap. -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/gh-fork-ribbon.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans:normal,italic,bold">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.2.0/respond.js"></script>
  <![endif]-->

  <!-- Load Bootstrap JavaScript components -->
  <script src="http://code.jquery.com/jquery.min.js"></script>
  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
  <style>
    .dark-blue-background a {
      color: white;
    }
  </style>
</head>
<body>
<!-- Responsive navbar -->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <!--  Display three horizontal lines when navbar collapsed. -->
        <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand">WattDepot</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="/index.html">Home</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Overview<b class="caret"></b></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/overview/architecture.html">Architecture</a></li>
            <li><a href="/overview/publications.html">Publications</a></li>
            <li><a href="/overview/news.html">News</a></li>
            <li><a href="/overview/history.html">History</a></li>
            <li><a href="https://groups.google.com/forum/#!forum/wattdepot-users">Discussion Group</a></li>
            <li class="divider"></li>
            <li><a href="https://github.com/wattdepot/wattdepot/blob/master/LICENSE.md">License</a></li>
          </ul>
        </li>
        <li><a href="/quick_start/quickstart.html">Quick Start</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Users<b class="caret"></b></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/overview/domainmodel.html">Domain model</a></li>
            <li><a href="/installationguide/administration.html">Administration</a></li>
            <li><a href="/">Data visualization</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Installation<b class="caret"></b></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/installationguide/prerequisites.html">Environment Prerequisites</a></li>
            <li><a href="/installationguide/installation.html">Basic installation</a></li>
            <li><a href="/installationguide/deploy-local.html">Deploying locally</a></li>
            <li><a href="/installationguide/deploy-heroku.html">Deploying to Heroku</a></li>
            <li><a href="/installationguide/administration.html">Administration</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Developers<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/developerguide/prerequisites.html">Environment prerequisites</a></li>
            <li><a href="/developerguide/downloading.html">Downloading WattDepot sources</a></li>
            <li><a href="/developerguide/building.html">Building the system</a></li>
            <li><a href="/developerguide/branching.html">WattDepot branching model</a></li>
            <li><a href="/developerguide/release.html">Making a release</a></li>
            <li class="divider"></li>
            <li><a href="/developerguide/writing-sensors.html">Writing sensors</a></li>
            <li><a href="/developerguide/writing-clients.html">Writing clients</a></li>
            <li class="divider"></li>
            <li><a href="/developerguide/persistence.html">Implementing persistence</a></li>
            <li><a href="/developerguide/evaluating-performance.html">Evaluating WattDepot
              performance</a></li>
            <li><a href="/developerguide/documentation.html">Documenting the system</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">APIs<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/api/http.html">HTTP</a></li>
            <li><a href="/api/java.html">Java</a></li>
            <li><a href="/api/javascript.html">Javascript</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</div>

<div class="github-fork-ribbon-wrapper right">
  <div class="github-fork-ribbon">
    <a href="https://github.com/wattdepot">WattDepot on GitHub</a>
  </div>
</div>

<!-- Load tocify css and js -->
<link type="text/css" rel="stylesheet" href="/css/jquery.tocify.css" />

<!-- Load tocify Javascript components -->
<script src="/js/jquery-ui-1.10.4.custom.js"></script>
<script src="/js/jquery.tocify.js"></script>

<div class="container">
<div class="row">
  <div class="hidden-xs col-sm-3" >
    <!-- Our table of contents will be here !-->
    <div id="nav"></div>
  </div>
  <div class="col-xs-12 col-sm-9">
     <h1>Prerequisites</h1>

<h2>Operating System</h2>

<p>The core development team has developed and run WattDepot on OS X, Windows 7, and Linux, so any of those platforms 
should be fine for development. We do not recommend Windows, instead use <a href="http://www.vagrantup.com/">Vagrant</a> to provide 
a good development environment.</p>

<h2>Java</h2>

<p>WattDepot requires <a href="http://www.oracle.com/us/technologies/java/standard-edition/overview/index.html">Java Platform Standard Edition</a> 
version 1.7 or above. If do not have Java installed you can get it from the previous link. Note that you will want the 
JDK (Java Development Kit) rather than the JRE (Java Runtime Environment) since you will be developing. To check the 
version of Java installed on your computer type <code>java -version</code> from the command line.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ java -version
java version &quot;1.7.0_40&quot;
Java(TM) SE Runtime Environment (build 1.7.0_40-b43)
Java HotSpot(TM) 64-Bit Server VM (build 24.0-b56, mixed mode)
</code></pre></div>
<h2>Maven</h2>

<p>WattDepot uses <a href="http://maven.apache.org/index.html">Maven3</a> as the build system. If you don&#39;t have Maven installed you 
can download it from the previous link. To check the version of Maven installed type <code>mvn -version</code> from the command line.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ mvn -version
Apache Maven 3.1.1 (0728685237757ffbf44136acec0402957f723d9a; 2013-09-17 05:22:22-1000)
Maven home: /usr/local/Cellar/maven/3.1.1/libexec
Java version: 1.7.0_40, vendor: Oracle Corporation
Java home: /Library/Java/JavaVirtualMachines/jdk1.7.0_40.jdk/Contents/Home/jre
Default locale: en_US, platform encoding: UTF-8
OS name: &quot;mac os x&quot;, version: &quot;10.9&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;
</code></pre></div>
<h2>Integrated Development Environment</h2>

<p>It is strongly recommended that you have a good Java IDE.</p>

<h2>PostgreSQL</h2>

<p>Currently, WattDepot is using Hibernate for the persistence layer and the <a href="http://www.postgresql.org/">PostgreSQL</a> 
database for storage. We recommend version 9.1 or higher. You can configure Hibernate to use other database backends, 
but we do not have experience with other backends at this time. To check the version of PostgreSQL type <code>psql -version</code> 
at the command line.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ psql --version
psql (9.2.4)
</code></pre></div>
<p>This actually checks the version of the PostgreSQL client.</p>

<h2>Git</h2>

<p>WattDepot uses Git and GitHub for our version control. You can install Git from <a href="http://git-scm.com/downloads">git-scm.com</a>. 
To check the version of git you have installed type <code>git --version</code> from the command line.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ git --version
git version 1.8.3.4 (Apple Git-47)
</code></pre></div>
<p>If you prefer a graphical interface to Git, GitHub has nice Git clients for <a href="http://mac.github.com/">OS X</a> and 
<a href="http://windows.github.com/">Windows</a> that can make your life easier. Since WattDepot is hosted at GitHub, the graphical 
GitHub client makes it very easy to work with Git and is highly recommended.</p>

<h1>Downloading Sources</h1>

<p>The WattDepot source code and documentation are hosted on <a href="http://github.com/">GitHub</a>, and are managed using 
<a href="http://git-scm.com/">Git</a>, which you should have installed as part of the <a href="#Prerequisites">Prerequisites</a>. 
You can clone the repository to your local system using either the command line or a GUI tool:</p>

<h2>Command line</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ git clone git@github.com:wattdepot/wattdepot.git
</code></pre></div>
<h2>GUI and IDE</h2>

<p>WattDepot&#39;s Git repository may be accessed using many different <a href="http://git-scm.com/downloads">client programs and plug-ins</a>. As mentioned above, we like the free clients provided by GitHub: 
<a href="http://mac.github.com/">GitHub for OS X</a> and <a href="http://windows.github.com/">GitHub for Windows</a>. 
On the <a href="http://github.com/wattdepot/wattdepot">WattDepot project page</a> there is a button labeled &quot;Clone in 
Desktop&quot; that will automatically launch your GitHub client and start the clone operation.</p>

<h2>Contributing to WattDepot</h2>

<p>If you plan to submit changes back to WattDepot, rather than cloning the WattDepot repository, you should first fork the 
repository on GitHub, and then clone it to your local system. This way, you can submit pull requests for bugs or new 
features that you add. First you will need to <a href="https://github.com/signup">create a GitHub account</a> if you don&#39;t have one 
already, and then follow the wonderful <a href="https://help.github.com/articles/fork-a-repo">GitHub forking tutorial</a>. You can 
read more about <a href="https://help.github.com/articles/using-pull-requests">pull requests at GitHub</a>.</p>

<h1>Building the System</h1>

<p>WattDepot uses <a href="http://maven.apache.org/index.html">Maven 3</a> as a build system. Maven is configured with the pom.xml 
file found at the root of the WattDepot source directory. Maven has a number of lifecycle phases - the most useful in 
this project are clean, compile, test, package, verify, and site.</p>

<ul>
<li><code>mvn clean</code> will delete the target directory.</li>
<li><code>mvn compile</code> will compile the project.</li>
<li><code>mvn test</code> will compile the project, then run JUnit and QA tests. (Note: the postgres storage implementation 
requires you to setup the wattdepot-server.properties file in order to supply the wattdepot-server.db.username 
property.)

<ul>
<li>FindBugs</li>
<li>Checkstyle </li>
<li>PMD</li>
<li>JavaDocs are created</li>
</ul></li>
<li><code>mvn package</code> will compile the project, run the tests, and then create .jar for a distribution

<ul>
<li>The .jar file</li>
<li>The POM zips everything into a distribution</li>
</ul></li>
<li><code>mvn verify</code> runs the compile, test and package phases and ensures the result is valid</li>
<li><code>mvn site</code> executes FindBugs, Checkstyle, PMD, and JavaDocs, then presents the results in an easy to read website 
(located in target/site)</li>
</ul>

<p>Rather than executing a whole phase, you can also run an individual goal. For example, to run FindBugs without doing 
anything else, use:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ mvn findbugs:check
</code></pre></div>
<p>The same works for <code>mvn pmd:check</code> and <code>mvn checkstyle:check</code>. However, note that this does not recompile the project. 
If you make changes to the source code, you should run <code>mvn compile</code> before running any other checks. </p>

<p>Another useful tip is adding properties to Maven calls with the <code>-D</code> argument. For example, to run the package phase 
without running JUnit tests, use:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$mvn package -DskipTests
</code></pre></div>
<p>This can be a great time saver if you&#39;ve just run the test phase and now want to package. These properties can also 
affect the running of WattDepot. Say you want to test multiple configurations without changing the 
wattdepot-server.properties file between each test. Try:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ mvn test -Dwattdepot-server.db.username=test
</code></pre></div>
<h1>WattDepot Branching Model</h1>

<h2>Centralized &quot;truth&quot; repository</h2>

<p>There is one central &quot;truth&quot; repository, origin, which is located at <a href="http://github.com/wattdepot/wattdepot">http://github.com/wattdepot/wattdepot</a>. It is the central push-pull location. Developers can of course clone their 
own repository and do whatever they want locally, but our model controls the structure of this repo. </p>

<h2>Two main branches: master and develop</h2>

<p>There are two main branches:</p>

<ul>
<li><p><a href="https://github.com/wattdepot/wattdepot/tree/master">master</a>. The HEAD of master always reflects a 
production-ready state. </p></li>
<li><p><a href="https://github.com/wattdepot/wattdepot/tree/develop">develop</a>. The HEAD of develop always reflects a state with 
the latest delivered development changes for the next release.</p></li>
</ul>

<p>When the source code in the develop branch reaches a stable point and is ready to be released, 
all of the changes should be merged back into master somehow and then tagged with a release number.</p>

<p>See <a href="branching.html">Branching Details</a> for more information.</p>

<h1>Making a Release</h1>

<p>Most implementation effort should be committed to the develop branch.  When appropriate, 
the develop branch will be merged into master and a release will be made.  This procedure is documented <a href="release.html">here</a>.  For the time being, Cam is the only one who will make releases. </p>

<h1>Deploying to Heroku</h1>

<p>We are thinking about using the <a href="https://blog.heroku.com/archives/2014/8/7/heroku-button">Heroku Button</a> for 
deploying to Heroku. This should be implemented soon. Check back often to see when we complete this work.  </p>

<h1>Writing Collector Processes</h1>

<p>TBW</p>

<h1>Writing Clients</h1>

<p>TBW</p>

<h2>Developing an HTML Dashboard</h2>

<p>TBW</p>

<h1>Implementing Persistence</h1>

<p>TBW</p>

<h1>Evaluating Performance</h1>

<h2>Goals</h2>

<p>There are several goals for WattDepot performance evaluation. We want to answer the following questions.</p>

<ol>
<li><p>What is the maximal throughput for Measurements?</p></li>
<li><p>What is the responsiveness, providing information about the Measurements and defined objects?</p></li>
<li><p>What happens to the system (throughput, responsiveness) after 24 hours, 7 days, ... of load?</p></li>
<li><p>What is the performance under a variety of simulated &quot;real world&quot; mixtures of puts and gets?</p></li>
<li><p>What are the answers to all of these questions on different platform installations (local machine, Mopsa, Heroku, ...)?</p></li>
</ol>

<h2>Performance Evaluation Tools</h2>

<p>We have provided several tools to help evaluate WattDepot&#39;s performance for several low level operations. These operations are:</p>

<ul>
<li>Put a measurement. Storing data in WattDepot.</li>
<li>Get the earliest value. Information about the measurements in WattDepot.</li>
<li>Get the latest value. This is typically how you would get the current power.</li>
<li>Get a value at a given time. This is generally how you would get the power or temperature at a given time.</li>
<li>Get a value from a start time to an end time. This is generally how you would calculate the Energy used.</li>
</ul>

<p>In the package</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">org.wattdepot.client.http.api.performance
</code></pre></div>
<p>you will find five programs:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">FindMeasurementThroughput    
FindGetEarliestValueThroughput
FindGetLatestValueThroughput
FindGetValueDateThroughput
FindGetValueDateDateThroughput
</code></pre></div>
<p>Each of the programs have the same command line arguments.</p>

<ul>
<li><p>-s <server URI>
: The URI to the WattDepot server. e.g. http://server.wattdepot.org:8192/</p></li>
<li><p>-u <username>
: The User Id of a defined WattDepot user.</p></li>
<li><p>-p <password>
: The User&#39;s password, used to connect to the WattDepot server.</p></li>
<li><p>-o <organizationId>
: The User&#39;s organization id.</p></li>
<li><p>-n <numSeconds>
: The number of seconds to run before checking the performance rates. We recommend values between 15 and 90. Shorter doesn&#39;t let the threads run often enough for a good average. Longer an you have to wait too long to see results.</p></li>
</ul>

<p>The programs start a monitoring thread that wakes up every <em>numSeconds</em> and checks the average time it took to perform the operation. The monitoring thread then calculates a new rate for the number of operations per second. The new rate is the average of the previous average times. Since it is an average of averages, the rate should slowly converge on the maximum rate possible. The monitoring thread then starts up the new rate worker threads that perform the operation once a second.</p>

<h3>Using the tools</h3>

<ol>
<li>Install WattDepot following the <a href="installationguide/installation">installation instructions</a>. You need to install version 3.0.0-M9 or above.</li>
<li>For performance testing we recommend you reduce the logging to a minimum. In the wattdepot-server.properties file change the <em>wattdepot-server.loggin.level</em> to SEVERE.</li>
<li><a href="installationguide/installation#Run%20the%20server">Start the WattDepot server</a>. </li>
<li>Define an Organization and User to use in the performance testing. Remember the User&#39;s password, we&#39;ll use it later.</li>
<li>Choose the performance evaluation(s) you want to run, Measurements, Earliest value, Latest value, Value at a given time, or Value from one time to another. 

<ul>
<li>We do not recommend running more than three of these tools at the same time. They can overload your WattDepot server.</li>
<li>We recommend you run the Measurements with the Get Values. This simulates a more realistic scenario, getting values while measurements are being added to the Server.<br></li>
</ul></li>
</ol>

<p>For example if you run the following:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ java -cp wattdepot-3.0.0-M9.jar org.wattdepot.client.http.api.performance.FindGetValueDateThroughput -s http://localhost:8192/ -u cmoore -p secret -o uh -n 15
</code></pre></div>
<p>You should see something like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Starting the Apache HTTP client
Stopping the HTTP client
Ave get value (date) time = 0.04042766666666667 =&gt; 25 gets/sec.
Setting rate to 25
Ave get value (date) time = 0.016198 =&gt; 62 gets/sec.
Setting rate to 35
Ave get value (date) time = 0.012042333333333334 =&gt; 83 gets/sec.
Setting rate to 44
Ave get value (date) time = 0.011197 =&gt; 89 gets/sec.
Setting rate to 50
Ave get value (date) time = 0.011237909090909092 =&gt; 89 gets/sec.
Setting rate to 55
Ave get value (date) time = 0.010520545454545454 =&gt; 95 gets/sec.
Setting rate to 59
</code></pre></div>
<p>Every 15 second two more lines are added to the output.  The output tells you what the average time it to perform the operation was and how many operations/second this results in. The second line tells you what the rate the tool is setting to get the next set of performance data. </p>

<p>The above data shows that we can perform about 90 get value at a given time operations per second.</p>

<p>Record your results.</p>

<h2>Real World Scenarios</h2>

<p>We&#39;ve used WattDepot in two distinct real world situations.  Supporting the Kukui Cup at University of Hawaii, Manoa and Hawaii Pacific University. <link to documentation?></p>

<h3>Kukui Cup: University of Hawaii, Manoa</h3>

<h4>Measurement Generation</h4>

<p>40 Sensors producing two measurements, power and energy, every 15 seconds (20 measurements/second).</p>

<h4>WattDepot Queries</h4>

<p>Makahiki status page generates queries about the latest measurement for each Lounge every 10 seconds. There are 20 Lounges (3.333 queries/second). The JavaScript calls <em>&lg;server_url&gt; + &quot;/depository/power/value/gviz/?sensor=&quot; + source + &quot;&amp;latest=true&quot;;</em> for each lounge.</p>

<p>Additionally, there are several activities that ask the players to explore the energy and power information stored in WattDepot.</p>

<p>Heat Map, Hot Spot, and Visualizer calls   <em>host_uri + &#39;/depository/&#39; + dataType + &#39;/values/gviz/?sensor=&#39; + source[i] +&#39;&amp;start=&#39; + startTime + &#39;&amp;end=&#39; + endTime + &#39;&amp;interval=&#39;+interval</em>
PowerMeter calls <em>&lg;server_url&gt; + &quot;/depository/power/value/gviz/?sensor=&quot; + source + &quot;&amp;latest=true&quot;;</em></p>

<p>Approximately 350 players times X % who do the activities equals N queries in a typical two week challenge. Based upon the 2014 Kukui Cup there were 61, 22, 21, 44 = 148 players who completed the activities.</p>

<h3>Kukui Cup: Hawaii Pacific University</h3>

<h4>Measurement Generation</h4>

<p>6 Sensors producing two measurements, power and energy, every 10 seconds (2 measurements/second).</p>

<h4>WattDepot Queries</h4>

<p>Makahiki status page generates queries about the latest measurement for each Team every 10 seconds. There are 6 teams (1 query/second). </p>

<p>Additionally, there are several activities that ask the players to explore the energy and power information stored in WattDepot.</p>

<p>Heat Map, Hot Spot, and Visualizer calls   </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;server_url&gt;/depository/&lt;depository_id&gt;/values/gviz/?sensor=&lt;sensor_id&gt;&amp;amp;start=&lt;startTime&gt;&amp;end=&lt;endTime&gt;&amp;interval=&lt;interval&gt;
</code></pre></div>
<p>PowerMeter calls </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;server_url&gt;/depository/&lt;depository_id&gt;/value/gviz/?sensor=&lt;sensor_id&gt;&amp;latest=true
</code></pre></div>
<h3>Aarhus University</h3>

<h4>Measurement Generation</h4>

<h4>WattDepot Queries</h4>

<h2>Results</h2>

<p><a href="results-mopsa.html">Feb 12th 2014 Mopsa Server</a></p>

  </div>
</div>
</div>

<script>
  $("#nav").tocify({theme: "bootstrap3", scrollTo: "40"});
</script>

<div class="dark-blue-background">
  <footer>
    <div class="container page-footer">
      <p>Continuous Integration:&nbsp;&nbsp; <a href="https://travis-ci.org/wattdepot/wattdepot/"><img
          src="https://api.travis-ci.org/wattdepot/wattdepot.png?branch=master"> (master)
        &nbsp;&nbsp;<img src="https://api.travis-ci.org/wattdepot/wattdepot.png?branch=develop"> (develop)</a>
      </p>

      <p>WattDepot is sponsored by:<br>
        Department of Information and Computer Sciences<br>
        University of Hawaii, Honolulu, HI USA</p>

      <p>Last update on: <span>11 Aug 2014</span></p>
    </div>
  </footer>
</div>
</body>
</html>
